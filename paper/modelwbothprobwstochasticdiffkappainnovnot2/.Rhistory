# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
# First obtain the data of unemp people only:
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Unemployed" & b$year_id == 1)]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
UNEMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(UNEMP$educ22)
tab2
tab1/tab2
x2 = tab1/tab2
# 3) Focus on the ones transitioning from unemp to self emp:
corresp_id = b$unique_id[1:(nrow(b) - 1)]
corresp_id = corresp_id[seq(1, length(corresp_id), by=2)]
selected_id = corresp_id[which(lfsta_emp[,1] == "Unemployed" & lfsta_emp[,2] == "Employed")]
b$UtoWW = ifelse(b$unique_id %in% selected_id, 1, 0)
summary(lm(UtoWW ~ as.numeric(finc)  + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22) + as.numeric(unemdur),data=b,weights=as.numeric(fnlwgt)))
summary(glm(UtoWW ~ as.numeric(finc) + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22) + as.numeric(unemdur), family=binomial(link="probit"),data=b,weights=as.numeric(fnlwgt)))
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 2),]
tab1 = table(D1$educ22)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
# First obtain the data of unemp people only:
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Unemployed" & b$year_id == 1)]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
UNEMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(UNEMP$educ22)
tab2
tab1/tab2
x4 = tab1/tab2
# 3bis) Worker to Unemployment
selected_id = corresp_id[which(lfsta_emp[,1] == "Employed" & lfsta_emp[,2] == "Unemployed")]
b$WWtoU = ifelse(b$unique_id %in% selected_id, 1, 0)
summary(lm(WWtoU ~ as.numeric(wage1) + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22), data=b,weights=as.numeric(fnlwgt)))
summary(glm(WWtoU ~ as.numeric(finc) + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22), family=binomial(link="probit"),data=b,weights=as.numeric(fnlwgt)))
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$educ22)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Employed" & b$year_id == 1)]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(EMP$educ22)
tab2
tab1/tab2
x3 = tab1/tab2
# 4) Worker to Self Employed by education
selected_id = corresp_id[which(lfsta_emp[,1] == "Employed" & lfsta_emp[,2] == "Self Employed")]
b$WWtoSE = ifelse(b$unique_id %in% selected_id, 1, 0)
summary(lm(WWtoSE ~ as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22) + I(as.numeric(educ22)^2), data=b,weights=as.numeric(fnlwgt)))
summary(lm(WWtoSE ~ as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(wage1) + I(as.numeric(wage1)^2), data=b,weights=as.numeric(fnlwgt)))
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$educ22)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Employed" & b$year_id == 1)]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(EMP$educ22)
tab2
tab1/tab2
x1 = tab1/tab2
# 4) Worker to Self Employed by education
selected_id = corresp_id[which(lfsta_emp[,1] == "Self Employed" & lfsta_emp[,2] == "Unemployed")]
b$SEtoU = ifelse(b$unique_id %in% selected_id, 1, 0)
summary(lm(SEtoU ~ as.numeric(finc) + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22), data=b,weights=as.numeric(fnlwgt)))
summary(lm(SEtoU ~ as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22), data=b,weights=as.numeric(fnlwgt)))
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$educ22)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Self Employed" & b$year_id == 1)]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(EMP$educ22)
tab2
tab1/tab2
x6 = tab1/tab2
par(mfrow=c(3,2),mar = c(1.5,2.5,2.5,1.5))
plot(x1, type="o", ylim=c(0.01, 0.017), main="WW to E")
plot(x2, type="o", col="red", ylim=c(0.01,0.045), main="U to E")
plot(x3, type="o", col="green", ylim=c(0.005,0.027), main="WW to U")
plot(x4, type="o", col="orange", ylim=c(0.14,0.27), main="U to WW")
plot(x5, type="o", col="blue", ylim=c(0.065,0.11), main="SE to WW")
plot(x6, type="o", col="blue", ylim=c(0.001,0.014), main="SE to U")
# USING Wage as proxy for 1. and 2.
# 4) Worker to Self Employed by education
selected_id = corresp_id[which(lfsta_emp[,1] == "Employed" & lfsta_emp[,2] == "Self Employed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$wagelvl)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Employed")]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(EMP$wagelvl)
tab2
tab1/tab2
x11 = tab1/tab2
#3bis) Worker to Unemployment
selected_id = corresp_id[which(lfsta_emp[,1] == "Employed" & lfsta_emp[,2] == "Unemployed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$wagelvl)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Employed")]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(EMP$wagelvl)
tab2
tab1/tab2
x32 = tab1/tab2
par(mfrow=c(2,1),mar = c(1.5,0,2.5,2.5))
plot(x1, type="o", ylim=c(0.008, 0.024), main="WW to E")
par(new=TRUE)
plot(x11, type="o", ylim=c(0.008, 0.024), col="red", main="WW to E")
plot(x3, type="o", col="black", ylim=c(0.005,0.029), main="WW to U")
par(new=TRUE)
plot(x32, type="o", col="red", ylim=c(0.005,0.04), main="WW to U")
x = seq(1,7,1)
lm(x32 ~x)
# 2) Focus on the ones transitioning from SE to WW:
corresp_id = b$unique_id[1:(nrow(b) - 1)]
corresp_id = corresp_id[seq(1, length(corresp_id), by=2)]
selected_id = corresp_id[which(lfsta_emp[,1] == "Self Employed" & lfsta_emp[,2] == "Employed")]
D = b[which(b$unique_id %in% selected_id),]
head(D)
D2 = D[which(D$year_id == 2),]
tab1 = table(D2$finc)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
# First obtain the data of unemp people only:
selected_id2 = corresp_id[which(lfsta_emp[,1] == "Self Employed")]
length(selected_id2)
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
SEtoEMP = b[which(b$unique_id %in% selected_id2 & b$year_id == 1),]
length(SEtoEMP)
tab2 = table(SEtoEMP$finc)
tab1/tab2
x555 = tab1/tab2
# 3) Focus on the ones transitioning from unemp to self emp:
corresp_id = b$unique_id[1:(nrow(b) - 1)]
corresp_id = corresp_id[seq(1, length(corresp_id), by=2)]
selected_id = corresp_id[which(lfsta_emp[,1] == "Unemployed" & lfsta_emp[,2] == "Self Employed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 2),]
tab1 = table(D1$finc)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
# First obtain the data of unemp people only:
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Unemployed")]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
UNEMP = b[which(b$unique_id %in% selected_id1 & b$year_id == 1),]
tab2 = table(UNEMP$finc)
tab2
tab1/tab2
x222 = tab1/tab2
# 3) Focus on the ones transitioning from unemp to self emp:
corresp_id = b$unique_id[1:(nrow(b) - 1)]
corresp_id = corresp_id[seq(1, length(corresp_id), by=2)]
selected_id = corresp_id[which(lfsta_emp[,1] == "Unemployed" & lfsta_emp[,2] == "Employed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 2),]
tab1 = table(D1$finc)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
# First obtain the data of unemp people only:
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Unemployed" )]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
UNEMP = b[which(b$unique_id %in% selected_id1 & b$year_id == 1),]
tab2 = table(UNEMP$finc)
tab2
tab1/tab2
x444 = tab1/tab2
# 3bis) Worker to Unemployment
selected_id = corresp_id[which(lfsta_emp[,1] == "Employed" & lfsta_emp[,2] == "Unemployed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$finc)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Employed")]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1 & b$year_id == 1),]
tab2 = table(EMP$finc)
tab2
tab1/tab2
x333 = tab1/tab2
# 4) Worker to Self Employed by education
selected_id = corresp_id[which(lfsta_emp[,1] == "Employed" & lfsta_emp[,2] == "Self Employed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$finc)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Employed")]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1 & b$year_id == 1),]
tab2 = table(EMP$finc)
tab2
tab1/tab2
x111 = tab1/tab2
# 4) Worker to Self Employed by education
selected_id = corresp_id[which(lfsta_emp[,1] == "Self Employed" & lfsta_emp[,2] == "Unemployed")]
D = b[which(b$unique_id %in% selected_id),]
D1 = D[which(D$year_id == 1),]
tab1 = table(D1$finc)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Self Employed")]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
EMP = b[which(b$unique_id %in% selected_id1 & b$year_id == 1),]
tab2 = table(EMP$finc)
tab2
tab1/tab2
x666 = tab1/tab2
par(mfrow=c(3,2),mar = c(1.5,2.5,2.5,1.5))
plot(x111, type="o", ylim=c(0.012, 0.045), main="WW to E")
plot(x222, type="o", col="red", ylim=c(0.01,0.07), main="U to E")
plot(x333, type="o", col="green", ylim=c(0.005,0.07), main="WW to U")
plot(x444, type="o", col="orange", ylim=c(0.3,0.5), main="U to WW")
plot(x555, type="o", col="blue", ylim=c(0.12,0.235), main="SE to WW")
plot(x666, type="o", col="blue", ylim=c(0.003,0.042), main="SE to U")
par(mfrow=c(3,2),mar = c(1.5,0,2.5,2.5))
plot(x1, type="l", ylim=c(0.008, 0.024), main="WW to E")
par(new=TRUE)
plot(x11, type="l", ylim=c(0.008, 0.024), col="red")
par(new=TRUE)
plot(x111, type="l", ylim=c(0.008, 0.024), col="blue")
plot(x2, type="l", ylim=c(0.01, 0.05), main="U to E")
par(new=TRUE)
plot(x222, type="l", ylim=c(0.01, 0.05), col="blue")
plot(x3, type="l", col="black", ylim=c(0.005,0.04), main="WW to U")
par(new=TRUE)
plot(x32, type="l", col="red", ylim=c(0.005,0.04))
par(new=TRUE)
plot(x333, type="l", ylim=c(0.005, 0.04), col="blue",)
plot(x4, type="l", ylim=c(0.13, 0.28), main="U to WW")
par(new=TRUE)
plot(x444, type="l", ylim=c(0.13, 0.28), col="blue")
plot(x5, type="l", col="black", ylim=c(0.06,0.13), main="SE to WW")
par(new=TRUE)
plot(x555, type="l", ylim=c(0.065, 0.11), col="blue")
selected_id1 = corresp_id[which(lfsta_emp[,1] == "Unemployed")]
UNEMP = b[which(b$unique_id %in% selected_id1),]
tab2 = table(UNEMP$educ22)
tab2
tab1/tab2
x2 = tab1/tab2
corresp_id = b$unique_id[1:(nrow(b) - 1)]
corresp_id = corresp_id[seq(1, length(corresp_id), by=2)]
selected_id = corresp_id[which(lfsta_emp[,1] == "Self Employed" & lfsta_emp[,2] == "Employed")]
b$SEtoWW = ifelse(b$unique_id %in% selected_id, 1, 0)
# selected_id2 = corresp_id[which(lfsta_emp[,1] == "Self Employed")]
# EE = b[which(b$unique_id %in% selected_id2 & b$year_id == 1),]
# model10 <- lm(SEtoWW ~   as.numeric(finc) + I(as.numeric(finc)^2) + I(as.numeric(finc)^3) , data=EE,weights=as.numeric(fnlwgt))
# nrow(EE)
# fitted = model10$coefficients[1] + model10$coefficients[2]*as.numeric(EE$finc) + model10$coefficients[3]*I(as.numeric(EE$finc)^2) + model10$coefficients[4]*I(as.numeric(EE$finc)^3)
# plot(as.numeric(EE$finc), fitted, type="p")
# modelEWWlm <- lm(SEtoWW ~  as.numeric(female) + as.numeric(age) + as.numeric(married) + as.numeric(finc) + I(as.numeric(finc)^2) + I(as.numeric(finc)^3),data=EE, weights=as.numeric(fnlwgt))
# summary(lm(SEtoWW ~ as.numeric(finc) + I(as.numeric(finc)^2) + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22) + I(as.numeric(educ22)^2),data=b,weights=as.numeric(fnlwgt)))
# summary(glm(SEtoWW ~ as.numeric(finc) + I(as.numeric(finc)^2) + as.numeric(married) + as.numeric(female) + as.numeric(age) + as.numeric(educ22) + I(as.numeric(educ22)^2), family=binomial(link="probit"),data=b,weights=as.numeric(fnlwgt)))
D = b[which(b$unique_id %in% selected_id),]
head(D)
D2 = D[which(D$year_id == 2),]
tab1 = table(D2$educ22)
tab1
# Obtain proba pour un chomeur de passer ? self employed, sachant son niveau d education
#
# First obtain the data of unemp people only:
selected_id2 = corresp_id[which(lfsta_emp[,1] == "Self Employed" & b$year_id == 1)]
#UNEMP = b[which(b$lfsta_emp == "Unemployed" & b$year_id == 1),]
SEtoEMP = b[which(b$unique_id %in% selected_id2),]
tab2 = table(SEtoEMP$educ22)
tab2
tab1/tab2
x5 = tab1/tab2
selected_id2 = corresp_id[which(lfsta_emp[,1] == "Self Employed" )]
SEtoEMP = b[which(b$unique_id %in% selected_id2),]
tab2 = table(SEtoEMP$educ22)
tab2
tab1/tab2
x5 = tab1/tab2
abline(h=0.23, lty=5, main="")
k1 <- 0.3135
k0 <- 0.81
k11 <- 0.151
k00 <- 0.836
f <- function(x){(x - (k0*x^(1-k1)))/x}
g <- function(x){(x - (k00*x^(1-k11)))/x}
fp <- function(x){(1 - (1-k1)*k0*x^(-k1))}
gp <- function(x){(1 - (1-k11)*k00*x^(-k11))}
par(mfrow=c(1,2))
curve(f, xlim=c(0.0,5.0), ylim=c(0.0,0.3), ylab="Average tax rate", xlab="Labor Income (thousand $)", col="red", main="Average tax rate")
par(new=TRUE)
curve(g, xlim=c(0.0,5.0), ylim=c(0.0,0.3), ylab="", xlab="", axes=FALSE)
legend("bottomright", c("US tax code", "CKK Optimal"), col=c("red","black"), cex= 0.9, lty=c(1,1))
curve(fp, xlim=c(0.0,5.0), ylim=c(0.0,0.3), ylab="Marginal tax rate", xlab="Labor Income (thousand $)", col="red", main="Marginal tax rate")
par(new=TRUE)
curve(gp, xlim=c(0.0,5.0), ylim=c(0.0,0.3), ylab="", xlab="", axes=FALSE)
abline(h=0.23, lty=5)
abline(v=0.72, lty=5)
legend("bottomright", c("US tax code", "CKK Optimal"), col=c("red","black"), cex= 0.9, lty=c(1,1))
curve(f, xlim=c(0.0,10.0), ylim=c(0.0,01.0), ylab="Average tax rate", xlab="Labor Income (thousand $)", col="red", main="Average tax rate")
par(mfrow=c(1,2))
curve(f, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="Average tax rate", xlab="Labor Income (thousand $)", col="red", main="Average tax rate")
par(new=TRUE)
curve(g, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="", xlab="", axes=FALSE)
legend("bottomright", c("US tax code", "CKK Optimal"), col=c("red","black"), cex= 0.9, lty=c(1,1))
par(mfrow=c(1,2))
curve(f, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="Average tax rate", xlab="Labor Income (thousand $)", col="red", main="Average tax rate")
par(new=TRUE)
curve(g, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="", xlab="", axes=FALSE)
legend("bottomright", c("French tax code", "US tax code"), col=c("red","black"), cex= 0.9, lty=c(1,1))
par(mfrow=c(1,2))
curve(f, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="Average tax rate", xlab="Labor Income (thousand $)", col="red", main="Average tax rate")
par(new=TRUE)
curve(g, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="", xlab="", axes=FALSE)
legend("topright", c("French tax code", "US tax code"), col=c("red","black"), cex= 0.9, lty=c(1,1))
par(mfrow=c(1,2))
curve(f, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="Average tax rate", xlab="Labor Income (thousand $)", col="red", main="Average tax rate")
par(new=TRUE)
curve(g, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="", xlab="", axes=FALSE)
legend("topright", c("French tax code", "US tax code"), col=c("red","black"), cex= 0.9, lty=c(1,1))
curve(fp, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="Marginal tax rate", xlab="Labor Income (thousand $)", col="red", main="Marginal tax rate")
par(new=TRUE)
curve(gp, xlim=c(0.0,10.0), ylim=c(0.0,1.0), ylab="", xlab="", axes=FALSE)
# abline(h=0.23, lty=5)
# abline(v=0.72, lty=5)
legend("bottomright", c("French tax code", "US tax code"), col=c("red","black"), cex= 0.9, lty=c(1,1))
setwd("/Users/alexandregaillard/Documents/Thesis/EntrepreneurshipUnemployment/Self-EmploymentUnemploymentEmployment/Codefinal/modelwbothprobwstochasticdiffkappainnovnot2")
necessity = read.table("distnecessity.out", sep="\t", header=TRUE)
neccesity = necessity[1:maxgrid,] + necessity[(maxgrid+1):(maxgrid*2),] + necessity[(maxgrid*2+1):(maxgrid*3),]
neccesity = neccesity/0.05
par(mfrow=c(1,1))
plot(neccesity$ASSET, neccesity$US + neccesity$UL, type="l", xlim=c(0,400), xlab="wealth", ylab="Necessity share")
setwd("/Users/alexandregaillard/Documents/Thesis/EntrepreneurshipUnemployment/Self-EmploymentUnemploymentEmployment/Codefinal/modelwbothprobwstochasticdiffkappainnovnot2")
necessity = read.table("distnecessity.out", sep="\t", header=TRUE)
neccesity = necessity[1:maxgrid,] + necessity[(maxgrid+1):(maxgrid*2),] + necessity[(maxgrid*2+1):(maxgrid*3),]
neccesity = neccesity/0.05
maxprod = 3
maxgrid = 250
maxtype = 2
setwd("/Users/alexandregaillard/Documents/Thesis/EntrepreneurshipUnemployment/Self-EmploymentUnemploymentEmployment/Codefinal/modelwbothprobwstochasticdiffkappainnovnot2")
necessity = read.table("distnecessity.out", sep="\t", header=TRUE)
neccesity = necessity[1:maxgrid,] + necessity[(maxgrid+1):(maxgrid*2),] + necessity[(maxgrid*2+1):(maxgrid*3),]
neccesity = neccesity/0.05
par(mfrow=c(1,1))
plot(neccesity$ASSET, neccesity$US + neccesity$UL, type="l", xlim=c(0,400), xlab="wealth", ylab="Necessity share")
abil1 = necessity[1:maxgrid,]
abil1
entrepreneur = read.table("distnecessity.out", sep="\t", header=TRUE)
entrepreneur = read.table("distVE.out", sep="\t", header=TRUE)
entrepreneur
entrepreneur = read.table("distasset.out", sep="\t", header=TRUE)
entrepreneur
necessity[(maxgrid*2+1):(maxgrid*3),]
necessity[1:maxgrid,]
entrepreneur
entrepreneur = entrepreneur$VE
entrepreneur
entrepreneurnecessity =  entrepreneur[1:23]
sum(entrepreneurnecessity)/sum(entrepreneur)
setwd("/Users/alexandregaillard/Documents/Thesis/EntrepreneurshipUnemployment/Self-EmploymentUnemploymentEmployment/Codefinal/modelwbothprobwstochasticdiffkappainnovnot2")
necessity = read.table("distWWtoVE.out", sep="\t", header=TRUE)
setwd("/Users/alexandregaillard/Documents/Thesis/EntrepreneurshipUnemployment/Self-EmploymentUnemploymentEmployment/Codefinal/modelwbothprobwstochasticdiffkappainnovnot2")
necessity = read.table("disttransitionWWtoVE.out", sep="\t", header=TRUE)
transWWtoVE = read.table("disttransitionWWtoVE.out", sep="\t", header=TRUE)
transWWtoVE = read.table("disttransitionWWtoVE.out", sep="\t", header=TRUE)
transWWtoVE
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition probability")
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2),] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2),] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3),] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3),] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
par(mfrow=c(1,1))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2),] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2),] , type="l", xlim=c(0,400), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3),] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3),] , type="l", xlim=c(0,400), col="blue",xlab= "", ylab="")
par(mfrow=c(1,1))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid] , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)] , type="l", xlim=c(0,400), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)] , type="l", xlim=c(0,400), col="blue",xlab= "", ylab="")
distWW = read.table("dist.out", sep="\t", header=TRUE)
distWW
abilWW1 = sum(distWW$WW1[1:maxgrid] + distWW$WW0[1:maxgrid])
abilWW1
abilWW2 = sum(distWW$WW1[(maxgrid+1):(maxgrid*2)] + distWW$WW0[(maxgrid+1):(maxgrid*2)])
abilWW2
abilWW1 = sum(distWW$WW1[1:maxgrid] + distWW$WW0[1:maxgrid])
abilWW3 = sum(distWW$WW1[(maxgrid*2+1):(maxgrid*3)] + distWW$WW0[(maxgrid*2+1):(maxgrid*3)])
abilWW2 = sum(distWW$WW1[(maxgrid+1):(maxgrid*2)] + distWW$WW0[(maxgrid+1):(maxgrid*2)])
abilWW3
par(mfrow=c(1,1))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", xlim=c(0,400), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", xlim=c(0,400), col="blue",xlab= "", ylab="")
transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.01), xlim=c(0,400), col="red", xlab="", ylab="")
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.001), xlim=c(0,400), col="red", xlab="", ylab="")
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0001), xlim=c(0,400), col="red", xlab="", ylab="")
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0005), xlim=c(0,400), col="red", xlab="", ylab="")
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0005), xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
par(mfrow=c(1,1))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0005), xlim=c(0,400), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0005), xlim=c(0,400), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", ylim=c(0,0.0005), xlim=c(0,400), col="blue",xlab= "", ylab="")
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid] , type="l", ylim=c(0,0.0005), xlim=c(0,400), xlab="wealth", ylab="Transition")
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)] , type="l", ylim=c(0,0.0005), xlim=c(0,400), col="red", xlab="", ylab="")
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)], type="l", ylim=c(0,0.0005), xlim=c(0,400), col="blue",xlab= "", ylab="")
par(mfrow=c(1,1))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0005), xlim=c(0,200), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0005), xlim=c(0,200), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", ylim=c(0,0.0005), xlim=c(0,200), col="blue",xlab= "", ylab="")
par(mfrow=c(1,1))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
distVE= read.table("distVE.out", sep="\t", header=TRUE)
distVE
abilVE1 = sum(distVE$VE[1:maxgrid*2])
abilVE1
abilVE2 = sum(distVE$VE1[(maxgrid*2+1):(maxgrid*4)])
abilVE2 = sum(distVE$VE[(maxgrid*2+1):(maxgrid*4)])
abilVE2
abilWW3 = sum(distVE$VE[(maxgrid*4+1):(maxgrid*6)])
transVEtoWW = read.table("disttransitionVEtoWW.out", sep="\t", header=TRUE)
transVEtoWW
transVEtoWW$ASSET[1:maxgrid*2]
transVEtoWW$ASSET
transVEtoWW
plot(transVEtoWW$ASSET[1:maxgrid*2], transVEtoWW$VEtoWW[1:maxgrid*2]/abilVE1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
abilVE3 = sum(distVE$VE[(maxgrid*4+1):(maxgrid*6)])
abilVE3
par(mfrow=c(1,2))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
plot(transVEtoWW$ASSET[1:maxgrid*2], transVEtoWW$VEtoWW[1:maxgrid*2]/abilVE1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transVEtoWW$ASSET[(maxgrid*2+1):(maxgrid*4)], transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*4)]/abilVE3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transVEtoWW$ASSET[(maxgrid*4+1):(maxgrid*6)], transVEtoWW$VEtoWW[(maxgrid*4+1):(maxgrid*6)]/abilVE3, type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
par(mfrow=c(1,2))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
plot(transVEtoWW$ASSET[1:maxgrid*2], transVEtoWW$VEtoWW[1:maxgrid*2]/abilVE1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transVEtoWW$ASSET[(maxgrid*2+1):(maxgrid*4)], transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*4)]/abilVE3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transVEtoWW$ASSET[(maxgrid*4+1):(maxgrid*6)], transVEtoWW$VEtoWW[(maxgrid*4+1):(maxgrid*6)]/abilVE3, type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
par(mfrow=c(1,2))
plot(transWWtoVE$ASSET[1:maxgrid] , transWWtoVE$WWtoVE[1:maxgrid]/abilWW1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid+1):(maxgrid*2)] , transWWtoVE$WWtoVE[(maxgrid+1):(maxgrid*2)]/abilWW2 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transWWtoVE$ASSET[(maxgrid*2+1):(maxgrid*3)] , transWWtoVE$WWtoVE[(maxgrid*2+1):(maxgrid*3)]/abilWW3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
plot(transVEtoWW$ASSET[1:maxgrid*2], transVEtoWW$VEtoWW[1:maxgrid*2]/abilVE1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
par(new=TRUE)
plot(transVEtoWW$ASSET[(maxgrid*2+1):(maxgrid*4)], transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*4)]/abilVE3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
par(new=TRUE)
plot(transVEtoWW$ASSET[(maxgrid*4+1):(maxgrid*6)], transVEtoWW$VEtoWW[(maxgrid*4+1):(maxgrid*6)]/abilVE3, type="l", ylim=c(0,0.0007), xlim=c(0,100), col="blue",xlab= "", ylab="")
plot(transVEtoWW$ASSET[1:maxgrid*2], transVEtoWW$VEtoWW[1:maxgrid*2]/abilVE1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
plot(transVEtoWW$ASSET[(maxgrid*2+1):(maxgrid*4)], transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*4)]/abilVE3 , type="l", ylim=c(0,0.0007), xlim=c(0,100), col="red", xlab="", ylab="")
transVEtoWW$ASSET[(maxgrid*2+1):(maxgrid*4)]
transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*4)]
transVEtoWW2 = transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*3)] + transVEtoWW$VEtoWW[(maxgrid*3+1):(maxgrid*4)]
transVEtoWW2
transVEtoWW3 = transVEtoWW$VEtoWW[(maxgrid*4+1):(maxgrid*5)] + transVEtoWW$VEtoWW[(maxgrid*5+1):(maxgrid*6)]
transVEtoWW1 = transVEtoWW$VEtoWW[1:(maxgrid*1)] + transVEtoWW$VEtoWW[(maxgrid*1+1):(maxgrid*2)]
transVEtoWW2 = transVEtoWW$VEtoWW[(maxgrid*2+1):(maxgrid*3)] + transVEtoWW$VEtoWW[(maxgrid*3+1):(maxgrid*4)]
transVEtoWW3 = transVEtoWW$VEtoWW[(maxgrid*4+1):(maxgrid*5)] + transVEtoWW$VEtoWW[(maxgrid*5+1):(maxgrid*6)]
plot(transVEtoWW$ASSET[1:maxgrid], transVEtoWW1[1:maxgrid]/abilVE1 , type="l", ylim=c(0,0.0007), xlim=c(0,100), xlab="wealth", ylab="Transition")
transVEtoWW1[1:maxgrid]
transVEtoWW$VEtoWW[1:(maxgrid*1)]
transVEtoWW$VEtoWW[(maxgrid*1+1):(maxgrid*2)]
plot(transVEtoWW$VEtoWW[1:(maxgrid*1)])
